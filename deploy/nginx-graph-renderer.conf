# graph-renderer: frontend (static files)
# ビルド済み dist を /graph-renderer/ で配信する
# 既存の server ブロック内に追加すること
#
# 事前に frontend をビルドしておくこと:
#   cd /var/www/html/projects/cidoc/graph-renderer/frontend
#   npm ci && npm run build

location /graph-renderer/ {
    alias /var/www/html/projects/cidoc/graph-renderer/frontend/dist/;
    index index.html;
    try_files $uri $uri/ =404;
}

# graph-renderer: FastAPI バックエンド (crmviz-api)
# ポート 8001 で動いている uvicorn へプロキシ
# systemd サービスは deploy/crmviz-api.service を参照
#
# location /crmviz-api/ {
#     proxy_pass http://127.0.0.1:8001/;
#     proxy_set_header Host $host;
#     proxy_set_header X-Real-IP $remote_addr;
#     proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#     proxy_set_header X-Forwarded-Proto $scheme;
# }
# ※ /crmviz-api/ は既存の nginx.conf に設定済みのためコメントアウト
